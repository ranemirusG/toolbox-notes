# Password Attacks






## Resources / Tools
Services such as <https://scatteredsecrets.com/> track password leaks and compromises and sell the plaintext passwords.


- `crunch` generate wordlists from a character set







## Password Spraying

This technique attempts to gain access to a system by 'spraying' a few commonly used passwords across a large number of accounts. For example, a cybercriminal uses 'Password123' with many usernames before trying again with a second commonly-used password, such as 'qwerty'.

- /usr/share/wordlists/dirb/others/names.txt


## Credential stuffing
Credentials obtained from a data breach on one service are used to attempt to log in to another unrelated service.




## Dictionary Attacks
Uses pre-selected list of options. Rather than trying every option, only try complete options which are likely to work.

- <https://en.wikipedia.org/wiki/RockYou#Data_breach>



## Brute-force Attacks
Attempts to determine a secret by trying every possible combination.



## Rainbow Attacks
Is generally an offline only attack.
	





## Pass-the-Hash (PtH)
Use of compromised password hash to authenticate and gain access to other systems on a network. Instead of cracking the hashed password, the attacker simply passes the hashed value to authenticate, bypassing the need to know the actual password. 








## Password cracking
The cracking time can be calculated by dividing the keyspace with the hash rate.

The keyspace consists of the character set to the power of the amount of characters or length of the original information (password). For example, if we use the lower-case Latin alphabet (26 characters), upper case alphabet (26 characters), and the numbers from 0 to 9 (10 characters), we have a character set of 62 possible variations for every character. If we are faced with a five-character password, we are facing 62 to the power of five possible passwords containing these five characters.




### Cracking methodology

1. Extract hashes
In a penetration test we'll find hashes in various locations. For example, if we get access to a database system, we can dump the database table containing the hashed user passwords.

Example: from a KeePass
```
Get-ChildItem -Path C:\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue
```

2. Format hashes
Identify the different types of hashes used to encrypt data
- `hashid`
- `hash-identifier`
- `ssh2john` and `keepass2john`


3. Calculate the cracking time
The cracking time consists of the keyspace divided by the hash rate. If the calculated cracking time exceeds our expected lifetime, we might reconsider this approach!

4. Prepare wordlist
In nearly all cases we should mutate our wordlist and perform a rule-based attack, instead of a straight dictionary attack. In this step, we should investigate potential password policies and research other password vectors, including online password leak sites. Without this, we may need to run multiple wordlists with (or without) pre-existing rules for a broad coverage of possible passwords.


5. Attack the hash


