# Path Traversal / Directory Traversal


Theoretically, we ccan add as many `../`as we want, since there is nowhere a further back to go from `/`.
This can be useful in certain situations, such as when we don't know our current working directory. In this case, we could specify a large number of `../` to ensure we reach the root file system from a relative pathing perspective.






In most cases, the web server is run in the context of a dedicated user such as `www-data`. These users usually have limited access permissions on the system. However, users and administrators often intentionally set file access permissions to be very permissive or even world-readable. Sometimes this occurs due to time constraints in deployment or less-mature security programs. This means we should always check for the existence of SSH keys and their access permissions.







## Resources

- <https://medium.com/@Steiner254/directory-path-traversal-288a6188076>





## Fuzzing

A lot of proxies or WAFs will normalize or block a typical ../ path traversal so try many different alternatives.


















## Linux
Use the `/etc/passwd` file to test directory traversal.



/var/www/html/file.html




In Linux systems, a standard vector for directory traversal is:
1. list the users of the system by displaying the contents of `/etc/passwd`
2. check for private keys in their home directory
3. use them to access the system via SSH


```
curl "http://mountaindesserts.com/meteor/index.php?page=../../../../../../../../home/offsec/.ssh/id_rsa" | sed -n '/BEGIN/,/END/p'
```












## Windows

Use the file `C:\Windows\System32\drivers\etc\hosts` (which is readable by all local users) to test directory traversal.


While RFC 1738 specifies to always use slashes in a URL, we may encounter web applications on Windows which are only vulnerable to directory traversal using backslashes. Therefore, we should always try to leverage both forward slashes and backslashes when examining a potential directory traversal vulnerability a  in a web application running on Windows.







- <https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/file_inclusion_windows.txt>



Microsoft Internet Information Services (IIS) default location: `C:\inetpub\Wwwroot\`

```
# the webserver is C:\inetpub\wwwroot\mailing\ and uses hMailServer
http://mailing.htb/download.php?file=../../../Program+Files+(x86)/hMailServer/Bin/hMailServer.INI

```


C:\inetpub\logs\LogFiles\W3SVC1\


Another file we should always check when the target is running an IIS web server is `C:\inetpub\wwwroot\web.config`, which may contain sensitive information like passwords or usernames.












