# Hashcat

- <https://hashcat.net/hashcat/>


## -a, --attack-mode=NUM

0 = Straight
1 = Combination
3 = Brute-force
6 = Hybrid Wordlist + Mask
7 = Hybrid Mask + WordlistI


## -m, --hash-type=NUM
0 = MD5

- <https://hashcat.net/wiki/doku.php?id=example_hashes>


```
hashcat --help | grep -i "Kerberos"
```





## Rules


`ls -la /usr/share/hashcat/rules/`

- <https://hashcat.net/wiki/doku.php?id=rule_based_attack#:~:text=The%20rule-based%20attack%20is%20like%20a%20programming%20language%20designed%20for>



`--stdout` starts Hashcat in debugging mode. In this mode, Hashcat will not attempt to crack any hashes, but merely display the mutated passwords.

```
echo \$1 > demo.rule
hashcat -r demo.rule --stdout demo.txt
password1
iloveyou1
princess1
rockyou1
abc1231
...
```














## Potfile

### Check Potfile
The message "All hashes found as potfile and/or empty entries" indicates that the hash might already be cracked and stored in hashcat's potfile. To check if this is the case, run:

```
hashcat --show [...]
hashcat --show -m 1000 "2a944a58d4ffa77137b2c587e6ed7626"

```





## Commands





As our Kali VM doesn't have access to a GPU, we'll also enter `--force` to ignore related warnings from Hashcat.








```
hashcat -m 1400 hash.txt -a 3 susan_nasus_?d?d?d?d?d?d?d?d?d

hashcat -a 0 -m 0 841bb5acfa6779ae432fd7a4e6600ba7 /usr/share/wordlists/rockyou.txt


hashcat -a 0 -m 5600 maya::MAILING:bb823b330caff09c:9CC801B6FD04789F071A0C3574754347:0101000000000000002D316E72C1DA01F86EE414A13C7AA80000000002000800390047004A004F0001001E00570049004E002D003800520049004600350050005600440052004600430004003400570049004E002D00380052004900460035005000560044005200460043002E00390047004A004F002E004C004F00430041004C0003001400390047004A004F002E004C004F00430041004C0005001400390047004A004F002E004C004F00430041004C0007000800002D316E72C1DA0106000400020000000800300030000000000000000000000000200000B24EDEDF6E5A151DADA508A5C6CE0A4001BFD23F0509030DF2D23051E7B3E17C0A001000000000000000000000000000000000000900220063006900660073002F00310030002E00310030002E00310034002E003200350033000000000000000000 /usr/share/wordlists/rockyou.txt



```



### NTLM
```
sudo hashcat -m 1000 "2a944a58d4ffa77137b2c587e6ed7626" /usr/share/wordlists/rockyou.txt -r myrule --force

```


### Kerberos

- AS-REP hash
```
sudo hashcat -m 18200 hashes.asreproast /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule --force
```

- TGS-REP hash
```
sudo hashcat -m 13100 hashes.kerberoast /usr/share/wordlists/rockyou.txt -r /usr/share/hashcat/rules/best64.rule --force

hashcat -m 13100 hash /usr/share/wordlists/rockyou.txt --force --potfile-disable
```
 