# Network



`C:\Windows\System32\drivers\etc` or `%WINDIR%\System32\drivers\etc`
`C:\Windows\System32\drivers\etc\hosts`: DNS file
`C:\Windows\System32\drivers\etc\networks`: Network Config file

Control Panel > Network and Internet > Network and Sharing Center

- C:\inetpub

- Cert:\ (`cd cert:`)











-> View interfaces and network information  
```
ipconfig /all
ipconfig /all;route print;arp -a;

for /L %i in (<start_port>,1,<end_port>) do echo "" | nc -vz <host> %i
```

-> View all active TCP connections and the TCP and UDP ports the host is listening on
```
netstat -ant
```

-> Firewall
```
netsh firewall show state
netsh firewall show config
```







## get IP
```
Get-NetComputer | ForEach-Object {
    $hostname = $_.dnshostname
    $ip = (Resolve-DnsName -Name $hostname | Where-Object { $_.QueryType -eq 'A' }).IPAddress
    [PSCustomObject]@{
        DNSHostName             = $hostname
        OperatingSystem         = $_.operatingsystem
        OperatingSystemVersion  = $_.operatingsystemversion
        IPAddress               = $ip
    }
} | Select-Object DNSHostName, OperatingSystem, OperatingSystemVersion, IPAddress


```














`Find-LocalAdminAccess` scans the network in an attempt to determine if our current user has administrative permissions on any computers in the domain. It relies on the `OpenServiceW` function which will connect to the Service Control Manager (SCM) on the target machines.

The SCM essentially maintains a database of installed services and drivers on Windows computers. PowerView will attempt to open this database with the `SC_MANAGER_ALL_ACCESS` access right, which require administrative privileges, and if the connection is successful, PowerView will deem that our current user has administrative privileges on the target machine.


Depending on the size of the environment, it may take a few minutes for `Find-LocalAdminAccess` to finish.

```
Find-LocalAdminAccess
Find-LocalAdminAccess -Domain dev.testlab.local


$SecPassword = ConvertTo-SecureString 'Password123!' -AsPlainText -Force
$Cred = New-Object System.Management.Automation.PSCredential('TESTLAB\dfm.a', $SecPassword)
Find-LocalAdminAccess -Domain testlab.local -Credential $Cred

```