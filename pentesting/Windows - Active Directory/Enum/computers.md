# Computers






## Enumerate domain joined machines

```
# Define the LDAP query
$LDAPFilter = "(&(objectCategory=computer)(objectClass=computer))"

# Use the DirectoryServices namespace to perform the search
$computers = [System.DirectoryServices.DirectorySearcher]::new($LDAPFilter)
$computers.FindAll() | ForEach-Object { $_.Properties["name"] }
```














## PowerView



Enumerate computer objects in the domain
```
Get-NetComputer
Get-NetComputer | select dnshostname,operatingsystem,operatingsystemversion





## Obtain information as which user is logged in to which computer
Query a given host for active sessions

`Get-NetSession` command uses the NetWkstaUserEnum and NetSessionEnum APIs under the hood.
Works with older systems.

- <https://learn.microsoft.com/en-us/windows/win32/api/lmshare/nf-lmshare-netsessionenum>



```
Get-NetSession -ComputerName [COMPUTER NAME] -Verbose
Get-NetSession -ComputerName files04 -Verbose
```



`NetWkstaUserEnum1` requires administrative privileges
`NetSessionEnum` doesn't require admininstrative privileges 

The permissions required to enumerate sessions with NetSessionEnum are defined in the `SrvsvcSessionInfo` registry key, which is located in the `HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer\DefaultSecurity` hive.
In order to view the permissions use the PowerShell `Get-Acl` cmdlet.

