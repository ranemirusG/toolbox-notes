# Active Directory Enumeration



Tell wheter is CMD or PowerShell:
```
(dir 2>&1 *`|echo CMD);&<# rem #>echo PowerShell
```



## PowerShell version
$PSVersionTable.PSVersion

### Check if current powershell session is a 64 bit process or not in windows
[system.environment]::Is64BitProcess






## Find files
```
gci -force -recursive -Path 'C:\users\' -include *.txt

Get-ChildItem -Path C:\ -Include *.kdbx -File -Recurse -ErrorAction SilentlyContinue
```















## Process Information
Get-Process
Get-Process | Select ProcessName,Path























## System Information

- systeminfo.exe
- msinfo32.exe




systeminfo | findstr /B /C:"OS Name" /C:"OS Version"


systeminfo | find /i "Install Date" #cmd
([WMI]'').ConvertToDateTime((Get-WmiObject Win32_OperatingSystem).InstallDate)



### get system information and save to file
msinfo32 /report ./my_report



### Installed Programs / Installed Software

Get-WmiObject -Class Win32_Product

Get-ItemProperty "HKLM:\SOFTWARE\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall\*" | select displayname
Get-ItemProperty "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*" | select displayname



### Startup Apps
C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp #Startup applications can be found here
Check writable permissions and transfer
The only catch here is the system needs to be restarted