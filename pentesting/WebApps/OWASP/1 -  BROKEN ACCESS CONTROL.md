# 1 -  BROKEN ACCESS CONTROL 
(#5 [2017])

- act outside of their intended permissions
- Permitting viewing or editing someone else's account, by providing its unique identifier (insecure direct object references - IDOR)
- Metadata manipulation, such as replaying or tampering with a JSON Web Token (JWT) access control token, or a cookie or hidden field manipulated to elevate privileges or abusing JWT invalidation.


## examples

Scenario #1: The application uses unverified data in a SQL call that is accessing account information:
```
pstmt.setString(1, request.getParameter("acct"));
ResultSet results = pstmt.executeQuery( );
```
An attacker simply modifies the browser's 'acct' parameter to send whatever account number they want. If not correctly verified, the attacker can access any user's account.

`https://example.com/app/accountInfo?acct=notmyacct`



Scenario #2: An attacker simply forces browses to target URLs. Admin rights are required for access to the admin page.

```
https://example.com/app/getappInfo
https://example.com/app/admin_getappInfo
```



## Prevention and measures

- Except for public resources, deny by default / Principle of Least Privilege

- Implement access control mechanisms once and re-use them throughout the application, including minimizing Cross-Origin Resource Sharing (CORS) usage.
	Access-Control-Allow-Origin Response Header (ACCESS PUBLIC PAGES)
	Access-Control-Allow-Credential Response Header (ACCES AUTHENTICATED PAGES, with cookies or other user credentials)
	

- Log All Access Control Events (indicative of a malicious user probing the application for vulnerabilities.) / Log access control failures, alert admins when appropriate (e.g., repeated failures).

