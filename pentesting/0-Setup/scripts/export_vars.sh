#!/bin/env bash

file="./project_vars.md"
temp_vars="$HOME/.local/zshrc/temp_vars"


# Check if the file exists
if [ -e "$temp_vars" ]; then
    # Delete the file if it exists
    rm "$temp_vars"
fi

# Create a new file (or replace it if it was deleted)
touch "$temp_vars"

# Check if variables file exists and is readable in the current directory
if [ -r "$file" ]; then
    # Read each line in the file
    while IFS= read -r line; do
        # Ignore lines that are not variable assignments
        if [[ "$line" =~ ^[[:space:]]*([^#=]+)=([^#]+)$ ]]; then
            # Extract variable name and value
            varname="${BASH_REMATCH[1]}"
            varvalue="${BASH_REMATCH[2]}"
            
            # Export the variable
            export "$varname"="$varvalue"
            echo "$varname=$varvalue" >> $temp_vars
            echo "Exported: $varname=$varvalue"
        fi
    done < "$file"
else
    echo "Error: $file does not exist or is not readable."
    exit 1
fi

