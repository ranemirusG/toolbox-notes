# Metasploit

## Resources and help
- <https://www.offsec.com/metasploit-unleashed/introduction/>
- <https://docs.metasploit.com/>

- man msfconsole
- man msfvenom


Config files: `/usr/share/metasploit-framework`






## Commands

### Start Metasploit Console
```
sudo msfdb init && msfconsole
sudo msfdb init && msfconsole -q
sudo msfconsole -q
```




### Move around and manage console

`back` to move out of the current context and return to the main prompt:
```
msf6 > use auxiliary/scanner/portscan/tcp
msf6 auxiliary(scanner/portscan/tcp) > back
msf6 >
```

- A variation of `back` is `previous`, which will switch us back to the previously selected module instead of the main prompt.



`ctrl+Z` or `background` Background session


### Sessions
```
sessions -l
sessions -i [NUMBER] # foreground session
sessions -u -[session number] # upgrade to shell?
```





### Search and use modules
```
show [MODULE TYPE]
show auxiliary


search -h
search [KEYWORDS]
search type:[MODULE TYPE]
search type:auxiliary name:smb



use [NUMBER]
use [MODULE NAME]
show options


set [OPTION] [VALUE]
Example: set RHOST [IP]

set
setg
unset
unsetg


run
exploit

```



















## Meterpreter
meterpreter not the same as shell

Is a multi-function payload that can be dynamically extended at run-time. In practice, this means that the Meterpreter shell provides more features and functionality than a regular command shell, offering capabilities such as file transfer, keylogging, and various other methods of interacting with the victim machine. These tools are especially useful in the post-exploitation phase. Because of Meterpreterâ€™s flexibility and capability, it is the favorite and most commonly-used Metasploit payload.

### Meterpreter commands
```
help
search meterpreter type:payload





```



















## Multi Handler (msfvenom + metasploit)

```
> use multi/handler
> set PAYLOAD windows/x64/meterpreter/reverse_tcp
> run # or  `exploit -j` (to run as background job)


```




























